@model ServerDetailsViewModel

@{
    ViewBag.Title = $"Confession - {@Model.Guild.Name}";
    Layout = "_Layout";
}

@await Component.InvokeAsync("GuildBanner", new GuildBannerViewParameters(Model.Guild.Id, true,
new List<BreadcrumbItem>()
{
    new BreadcrumbItem("Servers", "Server", "List"),
    new BreadcrumbItem(Model.Guild.Name, "Server", "Index", new Dictionary<string, string>()
    {
        {"id", Model.Guild.Id.ToString()}
    }),
    new BreadcrumbItem("Confession")
}))

<div class="row d-flex flex-row">
    <div class="m-1 col-auto">
        <form id="confession_settings" enctype="application/x-www-form-urlencoded" method="post" asp-controller="Server" asp-action="SaveSettings_Confession" asp-route-id="@Model.Guild.Id">
        
            <div class="row d-flex flex-row">
                <div class="m-1 col-auto">
                    @await Component.InvokeAsync("ChannelSelect", new ChannelSelectModel()
                    {
                        Channels = StrippedChannel.FromGuild(@Model.Guild),
                        Categories = StrippedCategory.FromGuild(@Model.Guild),
                        SelectedChannelId = @Model.CounterConfig.ChannelId,
                        ParentFormId = "confession_settings",
                        Name = "MessageChannelId",
                        Id = "confession_settings_channel_out",
                        DisplayName = "Message Channel"
                    })
                </div>
                <div class="m-1 col-auto">
                    @await Component.InvokeAsync("ChannelSelect", new ChannelSelectModel()
                    {
                        Channels = StrippedChannel.FromGuild(@Model.Guild),
                        Categories = StrippedCategory.FromGuild(@Model.Guild),
                        SelectedChannelId = @Model.CounterConfig.ChannelId,
                        ParentFormId = "confession_settings",
                        Name = "ModalChannelId",
                        Id = "confession_settings_channel_modal",
                        DisplayName = "Modal Channel"
                    })
                </div>
            </div>
            <a class="btn btn-danger mr-2" asp-controller="Server" asp-action="SaveSettings_Confession_Purge" asp-route-id="@Model.Guild.Id">Purge</a>
            <input class="btn btn-success" type="submit" value="Save"/>
        </form>
    </div>
</div>